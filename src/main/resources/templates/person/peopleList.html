<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.0.0-2/css/bootstrap.min.css} "/>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">-->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<!--    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
</head>
<body>
<th:block th:replace="share/header :: header"></th:block>
<div class="container" th:fragment="content">
    <div>
        <h1 style="text-align: center; margin: 0">Manage Person Information</h1>
    </div>
    <hr>
    <span style="color: red; margin-top:5px" id="validate"></span>
    <br>
    <br>
    <div  id="person-content">
    <table class="table table-striped">
        <form class="form-inline">
            <input class="form-control mr-sm-2" type="search" name="key" placeholder="Search by name or person id" aria-label="Search">
        </form>
        <thead>
        <th colspan="3">Person Information</th>
        <th></th>
        <th>
            <button type="button" id="add-person" class="btn btn-success" >Add new person</button>
        </th>
        </thead>
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">ID</th>
            <th scope="col">Name</th>
            <th scope="col">Gender</th>
            <th scope="col">Date of birth</th>
            <th scope="col">Classify</th>
            <th scope="col">Phone number</th>
            <th scope="col">Address</th>
<!--            <th colspan="2" scope="col">Action</th>-->
        </tr>
        </thead>
        <tbody>
        <tr th:each ="person, s : ${persons}" th:onclick="'showDetail('+${person.id}+')'">
            <td th:utext="${s.index +1}"></td>
            <td th:utext="${person.code}"></td>
            <td th:utext="${person.name}"></td>
            <td th:utext="${person.gender==true}?'Male':'Female'"></td>
            <td th:utext="${person.dateOfBirth}"></td>
            <td th:utext="${person.classify.classify}"></td>
            <td th:utext="${person.phone}"></td>
            <td th:utext="${person.address}"></td>
<!--            <td><a th:href="@{/persons/findById/(id=${person.id})}" class="btn btn-primary">Edit</a></td>-->
<!--            <td><a th:href="@{/persons/findById/(id=${person.id})}" class="btn btn-danger" id="deleteButton">Delete</a></td>-->
        </tr>
        </tbody>
    </table>
    <div>
        <ul class="nav nav-pills">
            <li class="nav-item" th:each="i:${#numbers.sequence(0,persons.totalPages-1)}">
                <a th:href="@{'/persons'(page=${i})}" th:text="${i+1}" class="nav-link" th:classappend="${persons.number}==${i}?'active':''"></a>
            </li>
        </ul>
    </div>
    </div>
</div>
<!-- show Modal -->
<div class="modal fade" id="showModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="showModalLabel">Add new person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: red">
                <div id="add-person-show-modal"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a type="button" data-toggle="modal" data-target="#confirmModal" onclick="addNewPerson()" data-dismiss="modal" class="btn btn-primary" >Confirm</a>
            </div>
        </div>
    </div>
</div>

<!-- show edit Modal -->
<div class="modal fade" id="editPersonModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPersonModalLabel">Update person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: red">
                <div id="edit-person-show-modal"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a type="button" data-toggle="modal" data-target="#confirmModal" onclick="editPerson()" data-dismiss="modal" class="btn btn-primary" >Confirm</a>
            </div>
        </div>
    </div>
</div>

<!-- show delete Modal -->
<div class="modal fade" id="deletePersonModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deletePersonModalLabel">Delete person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: red">
                <div id="delete-person-show-modal"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a type="button" data-toggle="modal" data-target="#confirmModal" onclick="deletePerson()" data-dismiss="modal" class="btn btn-primary" >Confirm</a>
            </div>
        </div>
    </div>
</div>

<!-- confirm Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmModalLabel">Add new person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="confirm-content" class="modal-body" style="color: red">
                Add new success!
            </div>
            <div class="modal-footer">
                <button type="button" onclick="reload()" class="btn btn-secondary" data-dismiss="modal">Close</button>
<!--                <a type="button" class="btn btn-primary" data-dismiss="modal">Confirm</a>-->
            </div>
        </div>
    </div>
</div>



<th:block th:replace="share/footer :: footer"></th:block>


<script th:inline="javascript">
let checkPhoneInput;
    function reload(){
        window.location.reload();
    }
    $(document).ready(function (){
        //show form add person
        $('#add-person').on('click',function (event){
            // event.preventDefault();
            let str = '<div class=login d-flex align-items-center py-5>\n '+
                 ' <div class=container>\n' +
                 '   <div class="row">\n' +
                 '    <div class="col-md-9 col-lg-8 mx-auto pl-5 pr-5">\n' +
                 '       <h3 class="login-heading mb-4">Add new person</h3>\n'+
            '<i style="color: black">Pls fill the form, have <i style="color: red">* </i>is required</i>'+
                 '       <form id="form" method="post">\n' +
                 '         <div class="form-label-group">\n' +
                '            <label for="add-person-name" class="text-secondary">Person name<i style="color: red">* </i></label>\n' +
                '<small style="color: red" id="check-add-person-name"></small>'+
                 '           <input type="text" name="add-person-name" id="add-person-name" required class="form-control" >\n' +
                '          </div>\n' +
                 '         <div class="form-label-group">\n' +
                 '           <label for="add-person-gender" class="text-secondary">Gender<i style="color: red">* </i></label>\n' +
                '<small style="color: red" id="check-add-person-gender"></small>'+
                '<select id="add-person-gender" class="form-control">\n' +
                 '   <option value="true">Male</option>\n' +
                 '   <option value="false">Female</option>\n' +
               ' </select>'+
                 '         </div>\n' +
                '          <div class="form-label-group mb-4 md-form md-outline input-with-post-icon datepicker">\n' +
                '            <label class="text-secondary">Date of birth<i style="color: red">* </i></label>\n' +
                '<small style="color: red" id="check-add-person-dob"></small>'+
                '            <input  type="date" name="add-person-dob" id="add-person-dob" required  class="form-control" >\n' +
                '          </div>\n' +
                '          <div class="form-label-group mb-4">\n' +
                '            <label class="text-secondary">Phone number<i style="color: red">* </i></label>\n' +
                '<small style="color: red" id="check-add-person-phone"></small>'+
                '            <input oninput="checkPhone()" type="number" id="add-person-phone" class="form-control" required>\n' +
                '<p></p>'+
                '          </div>\n' +
                '          <div class="form-label-group mb-4">\n '+
                 '           <span class="text-secondary">Classify<i style="color: red">* </i></span> <br><br><br>\n'+
                '<select id="add-person-classify" class="form-control">';
                var link = 'http://localhost:8080/classifies';
            $.get(link,function (classify, status){
                let classifyList = classify.slice();
                let html;
                $.each(classifyList, function (index, items){
                    // console.log("items laa ra", items.id)
                   html +='<option value="'+items.id+'">'+items.classify+'</option>'
                })
                $('#add-person-classify').append(html);
            })
            str +=  ' </select>'+
                '       </div>\n' +
                 '        <div class="form-label-group mb-4">\n' +
                 '           <label class="text-secondary">Address</label>\n' +
                 '           <input  type="text" id="add-person-address" class="form-control">\n' +
                '         </div>\n' +
                '          <div class="form-label-group mb-4">\n' +
                 '         </div>\n' +
                 '         <a data-toggle="modal" id="function-btn" data-target="#showModal" onclick="checkInput()" class="btn btn-lg btn-outline-primary btn-block btn-login text-uppercase font-weight-bold mb-2">Add new</a>\n' +
                 '         <a onclick="reload()" class="btn btn-lg btn-outline-primary btn-block btn-login text-uppercase font-weight-bold mb-2">Back</a>\n' +
                 '       </form>\n' +
                 '     </div>\n' +
                 '   </div>\n' +
                '  </div>\n' +
                '</div>'
            $('#person-content').html(str);
        })
    })

function checkPhone(){
        let id = $('#add-person-id').val();
        let phone = $('#add-person-phone').val();
        let href = "http://localhost:8080/persons/phone/"+phone
    if (id){
        $.ajax({
            async: false,
            url: "http://localhost:8080/persons/"+id,
            type: 'GET',
            success: function (data) {
               if (data.phone==phone){
                   checkPhoneInput = true;
               }else {
                   $.ajax({
                       async: false,
                       url: href,
                       type: 'GET',
                       success: function (data) {
                           if (!phone.match("(0[3|5|7|8|9])+([0-9]{8})\\b")){
                               checkPhoneInput = false
                               $('#check-add-person-phone').html("Phone number not correct format, phone contains 10 numbers begin with 0")
                           }else if (data=="existed"){
                               checkPhoneInput = false
                               $('#check-add-person-phone').html("Phone number existed,Pls try again")
                           }
                           else {
                               $('#check-add-person-phone').html("")
                               checkPhoneInput = true
                           }
                       }
                   })
               }
            }
        })
    }else {
        $.ajax({
            async: false,
            url: href,
            type: 'GET',
            success: function (data) {
                if (!phone.match("(0[3|5|7|8|9])+([0-9]{8})\\b")){
                    checkPhoneInput = false
                    $('#check-add-person-phone').html("Phone number not correct format, phone contains 10 numbers begin with 0")
                }else if (data=="existed"){
                    checkPhoneInput = false
                    $('#check-add-person-phone').html("Phone number existed,Pls try again")
                }
                else {
                    $('#check-add-person-phone').html("")
                    checkPhoneInput = true
                }
            }
        })
    }
}

function checkInput(){
    let code = $('#add-person-code').val();
    let id = $('#add-person-id').val();
    let name = $('#add-person-name').val();
    let dob = $('#add-person-dob').val();
    let phone = $('#add-person-phone').val();
    checkPhone()
    console.log("check phone", checkPhoneInput)
    if (name==""||name==null){
        $('#check-add-person-name').html("Name cannot blank");
        $('#function-btn').attr("data-target","");
        $('#function-btn').attr("data-toggle","");
    }else {
        $('#check-add-person-name').html("");
        if (code){
            $('#function-btn').attr("data-toggle","modal");
            $('#function-btn').attr("data-target","#editPersonModal");
            getEditPersonInfo();
        }else {
            $('#function-btn').attr("data-toggle","modal");
            $('#function-btn').attr("data-target","#showModal");
            getNewPersonInfo();
        }
    }
    if (dob==""||dob==null){
        $('#check-add-person-dob').html("Date of birth cannot blank");
        $('#function-btn').attr("data-target","");
        $('#function-btn').attr("data-toggle","");
    }else {
        $('#check-add-person-dob').html("");
        if (code){
            $('#function-btn').attr("data-toggle","modal");
            $('#function-btn').attr("data-target","#editPersonModal");
            getEditPersonInfo();
        }else {
            $('#function-btn').attr("data-toggle","modal");
            $('#function-btn').attr("data-target","#showModal");
            getNewPersonInfo();
        }
    }
    if (phone==""||phone==null){
        $('#check-add-person-phone').html("Phone cannot blank");
        $('#function-btn').attr("data-target","");
        $('#function-btn').attr("data-toggle","");
    }else {
if (checkPhoneInput){
    $('#check-add-person-phone').html("");
    if (code){
        $('#function-btn').attr("data-toggle","modal");
        $('#function-btn').attr("data-target","#editPersonModal");
        getEditPersonInfo();
    }else {
        // console.log("name lay ra", name)
        $('#function-btn').attr("data-toggle","modal");
        $('#function-btn').attr("data-target","#showModal");
        getNewPersonInfo();
    }
}else {
    checkPhone();
    $('#function-btn').attr("data-target","");
    $('#function-btn').attr("data-toggle","");
}
    }
}


    // show detail person form
    function showDetail(id){
            $.ajax({
                async: false,
                url: 'http://localhost:8080/persons/'+id,
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                    // console.log(data)
                    let str;
                    str +=
                        '  <div class="container">\n' +
                        '    <div class="row">\n' +
                        '      <div class="col-md-9 col-lg-8 mx-auto pl-5 pr-5">\n' +
                        '        <h3 class="login-heading mb-4" >Person Information</h3>\n' +
                        '<a style="margin-inline-end: auto; text-align: right" onclick="showEditForm()"><i class="far fa-edit">Edit</i></a>'+
                        '        <form>\n' +
                        '            <input type="text" disabled value="'+data.id+'" hidden id="add-person-id" class="form-control" >\n' +
                        '          <div class="form-label-group">\n' +
                        '            <label class="text-secondary">Person ID</label>\n' +
                        '            <input type="text" disabled value="'+data.code+'" id="add-person-code" class="form-control" >\n' +
                        '          </div>\n' +
                        '          <div class="form-label-group">\n' +
                        '            <label class="text-secondary">Person name</label>\n' +
                        '<small style="color: red" id="check-add-person-name"></small>'+
                        '            <input type="text" disabled value="'+data.name+'" id="add-person-name" class="form-control" >\n' +
                        '          </div>\n' +
                        '          <div class="form-label-group">\n' +
                        '            <label class="text-secondary">Gender</label>\n' +
                        '<small style="color: red" id="check-add-person-gender"></small>'+
                        '<select disabled id="add-person-gender" class="form-control">\n'
                    if (data.gender){
                        str +='   <option selected value="true">Male</option>\n' +
                            '   <option value="false">Female</option>\n'
                    }else {
                        str +='   <option  value="true">Male</option>\n' +
                            '   <option selected value="false">Female</option>\n'
                    }
                       str += ' </select>'+
                        '          <div class="form-label-group mb-4 md-form md-outline input-with-post-icon datepicker">\n' +
                        '            <label class="text-secondary">Date of birth</label>\n' +
                           '<small style="color: red" id="check-add-person-dob"></small>'+
                           '            <input disabled type="date" id="add-person-dob" value="'+data.dateOfBirth+'" class="form-control">\n' +
                    '          </div>\n' +
                        '          <div class="form-label-group mb-4">\n' +
                        '            <label class="text-secondary">Phone number</label>\n' +
                           '<small style="color: red" id="check-add-person-phone"></small>'+
                           '            <input disabled oninput="checkPhone()" type="number" value="'+data.phone+'" id="add-person-phone" class="form-control" required pattern="0((\\\\(\\\\d{3}\\\\))|\\\\d{3})?\\\\d{3}?\\\\d{4}$\">\n' +
                        '<p></p>'+
                        '          </div>\n' +
                        '          <div class="form-label-group mb-4">\n '+
                        '           <label class="text-secondary">Classify</label> <br><br><br>\n'+
                        '<select disabled id="add-person-classify" class="form-control">';
                    var link = 'http://localhost:8080/classifies';
                    $.get(link,function (classify, status){
                        let classifyList = classify.slice();
                        let html;
                        $.each(classifyList, function (index, items){
                            // console.log("items laa ra", items.id)
                            if (items.classify == data.classify.classify){
                                html +='<option selected value="'+items.id+'">'+items.classify+'</option>'
                            }else {
                                html +='<option value="'+items.id+'">'+items.classify+'</option>'
                            }
                        })
                        $('#add-person-classify').append(html);
                    })
                    str +=  ' </select>'+
                        '       </div>\n' +
                        '        <div class="form-label-group mb-4">\n' +
                        '           <label class="text-secondary">Address</label>\n' +
                        '           <input disabled type="text" value="'+data.address+'" id="add-person-address"  class="form-control">\n' +
                        '         </div>\n' +
                        '          <div class="form-label-group mb-4">\n' +
                        '         </div>\n' +
                        '         <a data-toggle="modal" id="function-btn" onclick="getDeletePersonInfo()" data-target="#deletePersonModal" class="btn btn-lg btn-outline-primary btn-block btn-login text-uppercase font-weight-bold mb-2">Delete</a>\n' +
                    '        <a onclick="reload()" class="btn btn-lg btn-outline-primary btn-block btn-login text-uppercase font-weight-bold mb-2">Back</a>\n' +
                    '       </form>\n' +
                        '      </div>\n' +
                        '    </div>\n' +
                        '</div>';
                    $('#person-content').html(str);
                }
            })
        }

    // get person info
    function getNewPersonInfo(){
        let name = $('#add-person-name').val();
        let genderId = $('#add-person-gender').val();
        let gender;
        if (genderId){
            gender = "Male";
        }else {
            gender = "Female"
        }
        let classifyId = $('#add-person-classify').val();
        let classify;
        let dob = $('#add-person-dob').val();
        let phone = $('#add-person-phone').val();
        let address = $('#add-person-address').val();
        let str;

        str += "<div class=\"form-group\">\n" +
            "                        <label class=\"col-form-label\">Name:</label>\n" +
            "                        <input type='text' disabled value='"+name+"' >\n" +
            "                    </div>"+
            "<div class=\"form-group\">\n" +
            "                        <label class=\"col-form-label\">Gender:</label>\n" +
            "                        <input type='text' disabled value='"+gender+"' >\n" +
            "                    </div>"+
            "<div class=\"form-group\">\n" +
            "                        <label class=\"col-form-label\">Date of birth:</label>\n" +
            "                        <input type='text' disabled value='"+dob+"' >\n" +
            "                    </div>"+
            "<div class=\"form-group\">\n" +
            "                        <label class=\"col-form-label\">Phone:</label>\n" +
            "                        <input type='text' disabled value='"+phone+"' >\n" +
            "                    </div>"+
            "<div class=\"form-group\">\n" +
            "                        <label class=\"col-form-label\">Address:</label>\n" +
            "                        <input type='text' disabled value='"+address+"' >\n" +
            "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label id='classify' class=\"col-form-label\">Classify:</label>\n"+
            "<input id='classifyShow' type='text' disabled value='' >"
        let href = "http://localhost:8080/classifies/"+classifyId;
        $.get(href,function (data,status){
            // console.log("data",data)
            classify = data.classify;
            // console.log("lay ra classify", classify)
            $('#classifyShow').val(classify);
        })
           str +=
            "                    </div>";
        $('#add-person-show-modal').html(str)
    }
// get edit person info
function getEditPersonInfo(){
        let id = $('#add-person-id').val();
    // console.log("lay ra duoc id hien tai k", id)
    let name = $('#add-person-name').val();
    let code = $('#add-person-code').val();
    let genderId = $('#add-person-gender').val();
    let gender;
    if (genderId){
        gender = "Male";
    }else {
        gender = "Female"
    }
    let classifyId = $('#add-person-classify').val();
    let classify;
    let dob = $('#add-person-dob').val();
    let phone = $('#add-person-phone').val();
    let address = $('#add-person-address').val();
    let str;

    str +=
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">ID:</label>\n" +
        "                        <input type='text' disabled value='"+code+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Name:</label>\n" +
        "                        <input type='text' disabled value='"+name+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Gender:</label>\n" +
        "                        <input type='text' disabled value='"+gender+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Date of birth:</label>\n" +
        "                        <input type='text' disabled value='"+dob+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Phone:</label>\n" +
        "                        <input type='text' disabled value='"+phone+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Address:</label>\n" +
        "                        <input type='text' disabled value='"+address+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label id='classify' class=\"col-form-label\">Classify:</label>\n"+
        "<input id='classifyShow' type='text' disabled value='' >"
    let href = "http://localhost:8080/classifies/"+classifyId;
    $.get(href,function (data,status){
        // console.log("data",data)
        classify = data.classify;
        // console.log("lay ra classify", classify)
        $('#classifyShow').val(classify);
    })
    str +=
        "                    </div>";
    $('#edit-person-show-modal').html(str)
}
//get delet person info
function getDeletePersonInfo(){
    let id = $('#add-person-id').val();
    // console.log("lay ra duoc id hien tai k", id)
    let name = $('#add-person-name').val();
    let code = $('#add-person-code').val();
    let genderId = $('#add-person-gender').val();
    let gender;
    if (genderId){
        gender = "Male";
    }else {
        gender = "Female"
    }
    let classifyId = $('#add-person-classify').val();
    let classify;
    let dob = $('#add-person-dob').val();
    let phone = $('#add-person-phone').val();
    let address = $('#add-person-address').val();
    let str;
    // console.log("lay id xoa",id)
    str +=
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">ID:</label>\n" +
        "                        <input type='text' disabled value='"+code+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Name:</label>\n" +
        "                        <input type='text' disabled value='"+name+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Gender:</label>\n" +
        "                        <input type='text' disabled value='"+gender+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Date of birth:</label>\n" +
        "                        <input type='text' disabled value='"+dob+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Phone:</label>\n" +
        "                        <input type='text' disabled value='"+phone+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label class=\"col-form-label\">Address:</label>\n" +
        "                        <input type='text' disabled value='"+address+"' >\n" +
        "                    </div>"+
        "<div class=\"form-group\">\n" +
        "                        <label id='classify' class=\"col-form-label\">Classify:</label>\n"
    let href = "http://localhost:8080/classifies/"+classifyId;
    $.get(href,function (data,status){
        // console.log("data",data)
        classify = data.classify;
        let html = "<input type='text' disabled value='"+classify+"' >"
        // console.log("lay ra classify", classify)
        $('#classify').append(html);
    })
    str +=
        "                    </div>";
    $('#delete-person-show-modal').html(str)

}

    // show edit form
    function showEditForm(){
      $('#add-person-name').attr("disabled", false);
        $('#add-person-gender').attr("disabled", false);
       $('#add-person-classify').attr("disabled", false);
        $('#add-person-dob').attr("disabled", false);
        $('#add-person-phone').attr("disabled", false);
       $('#add-person-address').attr("disabled", false);
       $('#function-btn').html("Update");
       $('#function-btn').attr("data-target","#editPersonModal");
       $('#function-btn').attr("onclick","checkInput()");
    }

// create new person
    function addNewPerson(){
        let name = $('#add-person-name').val();
        let genderId = $('#add-person-gender').val();
        let classifyId = $('#add-person-classify').val();
        let dob = $('#add-person-dob').val();
        let phone = $('#add-person-phone').val();
        let address = $('#add-person-address').val();
        let obj = {
            "name": name,
            "gender": genderId,
            "address":address,
            "phone": phone,
            "dateOfBirth": dob,
            "avatar":null,
            "classify": {
                "id": classifyId
            }
        }
        // console.log("type",typeof(obj))
        let data = JSON.stringify(obj)
        // console.log("data tao tu obj",data)
        $.ajax({
            async: false,
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            url: "http://localhost:8080/persons",
            type: 'POST',
            data: data,
            success: function (data) {
            }
        })
    }
// create new person
function editPerson(){
    let id = $('#add-person-id').val();
    let name = $('#add-person-name').val();
    let genderId = $('#add-person-gender').val();
    let classifyId = $('#add-person-classify').val();
    let dob = $('#add-person-dob').val();
    let phone = $('#add-person-phone').val();
    let address = $('#add-person-address').val();
    let obj = {
        "id": id,
        "name": name,
        "gender": genderId,
        "address":address,
        "phone": phone,
        "dateOfBirth": dob,
        "avatar":null,
        "classify": {
            "id": classifyId
        }
    }
    // console.log("type",typeof(obj))
    let data = JSON.stringify(obj)
    // console.log("data tao tu obj",data)
    $.ajax({
        async: false,
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        },
        url: "http://localhost:8080/persons",
        type: 'PUT',
        data: data,
        success: function (data) {
            // console.log("sau khi update", data)
            $('#confirmModalLabel').html("Update person confirm");
            $('#confirm-content').html("Update success!");
        }
    })
}
// create new person
function deletePerson(){
    let id = $('#add-person-id').val();
    // console.log("data tao tu obj",data)
    $.ajax({
        async: false,
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        },
        url: "http://localhost:8080/persons/"+id,
        type: 'PUT',
        success: function (data) {
            // console.log("sau khi update", data)
            $('#confirmModalLabel').html("Delete person confirm");
            $('#confirm-content').html("Delete success!");
        }
    })
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js" type="text/javascript"></script>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="Stylesheet" type="text/css" />
<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>

</body>
</html>