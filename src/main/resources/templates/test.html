<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Title</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap 4 DatePicker</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
</head>
<body>
<th:block th:replace="share/header :: header"></th:block>
<div class="container" th:fragment="content">
    <div>
        <h1 style="text-align: center; margin: 0">Manage Person Information</h1>
    </div>
    <hr>
    <span style="color: red; margin-top:5px" id="validate"></span>
    <br>
    <br>
    <div  id="person-content">
        <table class="table table-striped">
            <form class="form-inline">
                <input class="form-control mr-sm-2" type="search" name="key" placeholder="Search by name or person id" aria-label="Search">
            </form>
            <thead>
            <th colspan="3">Person Information</th>
            <th></th>
            <th>
                <button type="button" id="add-person" class="btn btn-success" >Add new person</button>
            </th>
            </thead>
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">ID</th>
                <th scope="col">Name</th>
                <th scope="col">Gender</th>
                <th scope="col">Date of birth</th>
                <th scope="col">Classify</th>
                <th scope="col">Phone number</th>
                <th scope="col">Address</th>
                <!--            <th colspan="2" scope="col">Action</th>-->
            </tr>
            </thead>
            <tbody>
            <tr th:each ="person, s : ${persons}" th:onclick="'showDetail('+${person.id}+')'">
                <td th:utext="${s.index +1}"></td>
                <td th:utext="${person.code}"></td>
                <td th:utext="${person.name}"></td>
                <td th:utext="${person.gender==true}?'Male':'Female'"></td>
                <td th:utext="${person.dateOfBirth}"></td>
                <td th:utext="${person.classify.classify}"></td>
                <td th:utext="${person.phone}"></td>
                <td th:utext="${person.address}"></td>
                <!--            <td><a th:href="@{/persons/findById/(id=${person.id})}" class="btn btn-primary">Edit</a></td>-->
                <!--            <td><a th:href="@{/persons/findById/(id=${person.id})}" class="btn btn-danger" id="deleteButton">Delete</a></td>-->
            </tr>
            </tbody>
        </table>
        <div>
            <ul class="nav nav-pills">
                <li class="nav-item" th:each="i:${#numbers.sequence(0,persons.totalPages-1)}">
                    <a th:href="@{'/persons'(page=${i})}" th:text="${i+1}" class="nav-link" th:classappend="${persons.number}==${i}?'active':''"></a>
                </li>
            </ul>
        </div>
    </div>
</div>
<!-- show Modal -->
<div class="modal fade" id="showModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="showModalLabel">Add new person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: red">
                <div id="add-person-show-modal"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a type="button" data-toggle="modal" data-target="#confirmModal" onclick="addNewPerson()" data-dismiss="modal" class="btn btn-primary" >Confirm</a>
            </div>
        </div>
    </div>
</div>

<!-- show edit Modal -->
<div class="modal fade" id="editPersonModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPersonModalLabel">Update person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: red">
                <div id="edit-person-show-modal"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a type="button" data-toggle="modal" data-target="#confirmModal" onclick="editPerson()" data-dismiss="modal" class="btn btn-primary" >Confirm</a>
            </div>
        </div>
    </div>
</div>

<!-- show delete Modal -->
<div class="modal fade" id="deletePersonModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deletePersonModalLabel">Delete person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: red">
                <div id="delete-person-show-modal"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a type="button" data-toggle="modal" data-target="#confirmModal" onclick="deletePerson()" data-dismiss="modal" class="btn btn-primary" >Confirm</a>
            </div>
        </div>
    </div>
</div>

<!-- confirm Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmModalLabel">Add new person confirm</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="confirm-content" class="modal-body" style="color: red">
                Add new success!
            </div>
            <div class="modal-footer">
                <button type="button" onclick="reload()" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <!--                <a type="button" class="btn btn-primary" data-dismiss="modal">Confirm</a>-->
            </div>
        </div>
    </div>
</div>

<input id="datepicker" width="276" />

<th:block th:replace="share/footer :: footer"></th:block>
<script>
    var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
    $('#datepicker').datepicker({
        minDate: today
    });
    $('#add-person-dob').datepicker({
        minDate: today
    });
    let checkPhoneInput;
    function reload(){
        window.location.reload();
    }
    $('#add-person').on('click',function (event){
        // event.preventDefault();
        let str = '<div class=login d-flex align-items-center py-5>\n '+
            ' <div class=container>\n' +
            '   <div class="row">\n' +
            '    <div class="col-md-9 col-lg-8 mx-auto pl-5 pr-5">\n' +
            '       <h3 class="login-heading mb-4">Add new person</h3>\n'+
            '<i style="color: black">Pls fill the form, have <i style="color: red">* </i>is required</i>'+
            '       <form id="form" method="post">\n' +
            '         <div class="form-label-group">\n' +
            '            <label for="add-person-name" class="text-secondary">Person name<i style="color: red">* </i></label>\n' +
            '<small style="color: red" id="check-add-person-name"></small>'+
            '           <input type="text" name="add-person-name" id="add-person-name" required class="form-control" >\n' +
            '          </div>\n' +
            '         <div class="form-label-group">\n' +
            '           <label for="add-person-gender" class="text-secondary">Gender<i style="color: red">* </i></label>\n' +
            '<small style="color: red" id="check-add-person-gender"></small>'+
            '<select id="add-person-gender" class="form-control">\n' +
            '   <option value="true">Male</option>\n' +
            '   <option value="false">Female</option>\n' +
            ' </select>'+
            '         </div>\n' +
            '          <div class="form-label-group input-with-post-icon datepicker">\n' +
            '            <label class="text-secondary">Date of birth<i style="color: red">* </i></label>\n' +
            '<small style="color: red" id="check-add-person-dob"></small>'+
            '            <input  name="add-person-dob" id="datepicker" required  class="form-control datepicker" >\n' +
            '          </div>\n' +
            '          <div class="form-label-group mb-4">\n' +
            '            <label class="text-secondary">Phone number<i style="color: red">* </i></label>\n' +
            '<small style="color: red" id="check-add-person-phone"></small>'+
            '            <input oninput="checkPhone()" type="number" id="add-person-phone" class="form-control" required>\n' +
            '<p></p>'+
            '          </div>\n' +
            '          <div class="form-label-group mb-4">\n '+
            '           <span class="text-secondary">Classify<i style="color: red">* </i></span> <br><br><br>\n'+
            '<select id="add-person-classify" class="form-control">';
        var link = 'http://localhost:8080/classifies';
        $.get(link,function (classify, status){
            let classifyList = classify.slice();
            let html;
            $.each(classifyList, function (index, items){
                // console.log("items laa ra", items.id)
                html +='<option value="'+items.id+'">'+items.classify+'</option>'
            })
            $('#add-person-classify').append(html);
        })
        str +=  ' </select>'+
            '       </div>\n' +
            '        <div class="form-label-group mb-4">\n' +
            '           <label class="text-secondary">Address</label>\n' +
            '           <input  type="text" id="add-person-address" class="form-control">\n' +
            '         </div>\n' +
            '          <div class="form-label-group mb-4">\n' +
            '         </div>\n' +
            '         <a data-toggle="modal" id="function-btn" data-target="#showModal" onclick="checkInput()" class="btn btn-lg btn-outline-primary btn-block btn-login text-uppercase font-weight-bold mb-2">Add new</a>\n' +
            '         <a onclick="reload()" class="btn btn-lg btn-outline-primary btn-block btn-login text-uppercase font-weight-bold mb-2">Back</a>\n' +
            '       </form>\n' +
            '     </div>\n' +
            '   </div>\n' +
            '  </div>\n' +
            '</div>'
        $('#person-content').html(str);
    })

</script>
</body>
</html>